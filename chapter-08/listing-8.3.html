<!-- 第8章 スレッドとタイマの扱い方 -->
<!-- 8.3 計算コストが高い処理に対処する -->
<!-- chapter08：リスト8-3 タイマを使って長期タスクを分割する -->

<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<script src="../scripts/assert.js" type="text/javascript"></script>
	<link href="../styles/assert.css" type="text/css" rel="stylesheet">

</head>
<body>
	<table>
		<tbody></tbody>
	</table>
	<script>
		var tbody = document.getElementsByTagName("tbody")[0];

		var rowCount = 20000;
		var divideInto = 4;
		var chunkSize = rowCount / divideInto;
		var iteration = 0;

		setTimeout(function generateRows () {

			var counter = chunkSize * iteration;
			for(var i = counter; i < counter + chunkSize; i++){
				var tr = document.createElement("tr");
				for(var t = 0; t < 6; t++){
					var td = document.createElement("td");
					td.appendChild(document.createTextNode(i + ", " + t));
					tr.appendChild(td);
				}
				tbody.appendChild(tr);					
			}
			iteration++;

			if (iteration < divideInto) {
				setTimeout(generateRows, 0);
			}
		},0)

	</script>
	
</body>
</html>

