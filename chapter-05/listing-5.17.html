<!-- chapter05：リスト5-17 クロージャ内の反復子（イテレータ）が思ったように動作しない -->
<!-- ループとクロージャの不愉快な問題を解決する -->

<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<script src="../scripts/assert.js" type="text/javascript"></script>
	<link href="../styles/assert.css" type="text/css" rel="stylesheet">

</head>
<body>
	<div>DIV 0</div>
	<div>DIV 1</div>

	<script>
		var divs = document.getElementsByTagName("div");

		// イベントハンドラの典型的な間違え
		// イベントハンドラに設定された関数はiをクロージャ内に抱え込んでいる
		// そこでiはdivを2つ設定しているので、2の状態を保持している。
		// なので、どこをクリックしても、2番がクリックされたことになっている
		for (var i = 0; i < divs.length; i++) {
			divs[i].addEventListener("click", function () {
				alert("DIVの" + i + "番がクリックされました");
			}, false);
		};

	</script>
	
</body>
</html>